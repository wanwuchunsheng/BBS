<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>海伦社区</title>
<meta name="keywords" content="海伦国际,武汉海伦国际,青山海伦国际,武东海伦国际,武汉青山海伦国际,武汉青山海伦国际论坛,武东,青山,社区,海伦社区,海伦国际论坛,武汉青山,武汉武东,武东区,青山武东社区,青山海伦国际论坛,青山海伦国际论坛"/>
<meta name="description" content="武汉青山海伦国际论坛，方便业主相互交流，分享生活。海伦国际欢迎各业主加入QQ【总】群:645952730"/>
<meta name="author" content="详细页" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<script type="text/jscript" src="${resRoot}/view/js/jquery-1.8.2.min.js" ></script>
<script type="text/jscript" src="${resRoot}/view/js/common.js"></script>

<!-- icon-font -->
<link rel="stylesheet" href="${resRoot}/view/css/font-awesome.min.css" />
<!--[if IE 7]>
<link href="${resRoot}/view/css/font-awesome-ie7.min.css" rel="stylesheet" type="text/css" />
<![endif]-->

<!-- layui 2.0 -->
<link rel="stylesheet" href="${resRoot}/view/css/layui.css" />
<!-- 自定义 -->
<link rel="stylesheet" href="${resRoot}/view/css/global.css" />
<link rel="stylesheet"  data-href="${resRoot}/view/css/stretch.css" class="fly-style" />
<link rel="stylesheet" href="${resRoot}/view/css/style.css" />
<link rel="stylesheet" href="${resRoot}/view/css/common.css" />
<link rel="stylesheet" href="${resRoot}/view/wangEditor/wangEditor.min.css" />
<link rel="stylesheet" href="${resRoot}/view/wangEditor/wangEditor-fullscreen-plugin.css" />
<link rel="stylesheet" href="${resRoot}/view/wangEditor/wangEditor.css" />
<link rel="shortcut icon" href="${resultImgPath}/bbs/bbs_icon/favicon.ico" />
<script type="text/javascript" src="${resRoot}/view/wangEditor/wangEditor.js"></script>
<script type="text/javascript" src="${resRoot}/view/wangEditor/wangEditor-fullscreen-plugin.js"></script>
<style type="text/css">
 .w-e-text{
  overflow-x:visible;
  overflow-y:visible;
  }
</style>
</head>

<body>
<!-- heand -->
<div class="header">
  <div class="main">
		<a class="logo"  href="#" title="海伦社区">
		  <img class="logo-img" src="${resultImgPath}/bbs/bbs_icon/logo.png"  />
		</a>
       
		<div class="nav" >
			<ul>
			<li>
			<a href="${futRoot}/view/index">
				<i class="iconfont icon-desktop"></i>首页
			</a>
			</li>
			
			<li>
			<a href="${futRoot}/cont/index"  >
				<i class="iconfont  icon-leaf"></i>综合区
			</a>
			</li>
            <li>
			<a href="${futRoot}/que/index" class="">
				<i class="iconfont icon-tags"></i>反馈
			</a>
			</li>
			<li class="newMsg">
			<a href="${futRoot}/mine/index" class=" layui-hide">
				<i class="iconfont icon-user"></i>我的
			</a>
            </li>
            
			</ul>
		</div>
        
		<div class="nav-user unlogin">
		  <#if (bbsUserInfo)?? >
		     <div class="loginuser-span">
			     <a href="${futRoot}/mine/index">
			         <img class="fly-list-avatar-img loginuser-img" src="${resultImgPath}/bbs/bbs_icon/${bbsUserInfo.photoPath?if_exists}" />
			     </a>
			     <span class="loginuser-signin"> 
			        <a>${bbsUserInfo.niceName?if_exists}</a>
			     </span>
			     <span class="loginuser-signin"> 
			        <a  href="${futRoot}/mine/logout"><i class="iconfont icon-signin"></i>  注销</a>
			     </span>
		     </div>
		  <#else>
			   <span>
					<a href="${futRoot}/mine/login">登入</a>
					<a href="${futRoot}/mine/reg">注册</a>
				</span> 
				<p class="out-login">
				    <a href="#" class="iconfont icon-comments" title="微信登录"></a>
					<a href="#" class="iconfont icon-weibo" title="微博登录"></a>
				</p>
		  </#if>
		</div>		
  </div>
</div>
<!-- heand end -->

<!-- content -->
<div class="main layui-clear">

<!-- 左边内容 -->
<div class="wrap">
	<div class="content detail">
		<div class="fly-panel detail-box fly-art">
			<!-- 标题 -->
			<h1 id="getLocation">${postsObj.title?if_exists}
			    <#if (postsObj.contStatus==0) >
					   <#if (postsObj.contRec==1) >
	                      <i class="layui-btn layui-btn-xs layui-bg-red">加精</i>
	                   <#elseif (postsObj.contReward>0) >
	                      <i class="layui-btn layui-btn-xs layui-bg-orange">悬赏</i>
	                   <#elseif (postsObj.contReply>100) >
	                      <i class="layui-btn layui-btn-xs layui-bg-blue">围观 </i>
	                   </#if>
                 <#elseif (postsObj.contStatus==1) >
                          <i class="layui-btn layui-btn-xs layui-bg-gray">已结</i>
                 </#if>
			</h1> 
			<!-- 标题 end-->
			
			<div class="fly-tip fly-detail-hint">
				<div class="fly-list-hint">
				    <#if (postsObj.contReward>0) >
	                   <i class="iconfont  icon-strikethrough"  title="悬赏"></i> ${postsObj.contReward?if_exists}
	                </#if>
					<i class="iconfont icon-eye-open" title="人气"></i> ${postsObj.contPreview?if_exists}
					<a href="#comment"><i class="iconfont icon-comment" title="回答"></i> ${postsObj.contReply?if_exists}	</a> 
				</div>
			</div>
			<br/>
			<!-- 用户信息  -->
			<div class="detail-about">
				<a class="jie-user" href="${futRoot}/mine/preview?id=${postsObj.createUserId?if_exists}" target="_blank">
					<img id="shareImg" src="${resultImgPath}/bbs/bbs_icon/${postsObj.imgPath?if_exists}"  />
					<cite>
						<i>${postsObj.niceName?if_exists}</i>
						<em>发布于 ${postsObj.createDate?string("yyyy-MM-dd HH:mm:ss")}</em>
					</cite> 
				</a>
				<div class="detail-hits" id="LAY_jieAdmin" data-id="12345">
					<span style="color:#FF7200">经验值：<i class="layui-badge-ico layui-badge layui-bg-gary">${postsObj.expPoints?if_exists}</i></span> 
				</div>
			</div>
			<!-- 用户信息 end  -->
			<!-- 内容信息  detail-body photos  -->
			<div class="w-e-text" contenteditable="true">
				${postsObj.content?if_exists}		
			</div>
			<br/>
			<!-- 内容信息end  -->
			<div class="cont-more">
				<button id="contGood" onclick="checkButTyp(${postsObj.id?if_exists},1,'contGood',${postsObj.contGood?if_exists})" class="layui-btn layui-btn-normal">
				     <i class="iconfont icon-thumbs-up" title="支持"></i>&nbsp;支持&nbsp;&nbsp;+<font class="contGood">${postsObj.contGood?if_exists}</font>	
				</button>
				<button id="contBad" onclick="checkButTyp(${postsObj.id?if_exists},2,'contBad',${postsObj.contBad?if_exists} )" class="layui-btn layui-btn-warm">
				     <i class="iconfont icon-thumbs-down" title="支持"></i>&nbsp;反对&nbsp;&nbsp;+<font class="contBad">${postsObj.contBad?if_exists}	</font>
				</button>
				<#if (bbsUserInfo)??>
					 <button id="contColl" onclick="checkButTyp(${postsObj.id?if_exists},3,'contColl',${postsObj.contColl?if_exists})" class="layui-btn layui-btn-danger">
					     <i class="iconfont icon-star-empty" title="收藏"></i>&nbsp;收藏&nbsp;&nbsp;+<font class="contColl">${postsObj.contColl?if_exists}</font>
					 </button>
				 <#else>
				      <button  onclick="layer.msg('未登录')" class="layui-btn layui-btn-danger">
				      <i class="iconfont icon-star-empty" title="收藏"></i>&nbsp;收藏&nbsp;&nbsp;+${postsObj.contColl?if_exists}
				      </button>
				  </#if>
            </div>
            <br/>
		</div>
		
		<!-- 回帖信息 -->
		<div class="commentBox fly-panel detail-box" style="padding-top: 0;">
			<fieldset class="layui-elem-field layui-field-title" style="text-align: center;"><legend>回帖</legend> </fieldset>
			<ul class="jieda" id="jieda">
				<!-- 评论 -->
				<#if (replyAll?size > 0)>
		        <#list replyAll as rep>
				<li data-id="13" id="comment13" data-type="discuz">
					<div class="detail-about detail-about-reply fly-detail-user">
						<div class="jieda-comment">
							<a class="delOnclick_${rep.id?if_exists}" onclick="queryReplyCount( ${rep.id?if_exists},'${rep.createUserName?if_exists}',${rep.replyCout?if_exists} )">
								<span type="comment" class="comment-btn">
									留言  (${rep.replyCout?if_exists}) 
								</span> 
							</a>
							<a href="#reviewInfo" onclick="nowReplay(${rep.id?if_exists},'${rep.createUserName?if_exists}',${ (rep.id?if_exists) })">
								<span type="comment" class="comment-btn">
									<i class="iconfont icon-comment"></i>回复
								</span> 
							</a>
						</div>
						<div class="jie-user comment-user">
							<a href="${futRoot}/mine/preview?id=${rep.createUserId?if_exists}" target="_blank">
							<img src="${resultImgPath}/bbs/bbs_icon/${rep.imgPath?if_exists}" >
							<cite>
								<i>${rep.createUserName?if_exists}</i>
							</cite> 
							</a>
						</div>
						<div class="detail-hits">
							<span>${rep.createDate?string("yyyy-MM-dd HH:mm:ss")}</span> 
						</div>
					</div>
					<div class="detail-body comment-body jieda-body photos">
                        ${rep.content?if_exists}
                    </div>
					<!-- 回复 -->
					<div id="selCount_${rep.id?if_exists}" class="replayList replayDetail64"> 
					    
				    </div>
				</li>
				</#list>
				<div id="nedv"></div>
				    <#if (pageObj.currentPage < pageObj.pageCount) >
					<div class="cont-more">
					<br/>
				    <br/>
					   <a  href="javascript:;" onclick="queryDetailPage(${postsObj.id?if_exists})" class="layui-btn layui-btn-big layui-btn-primary">获取更多>></a>
				    </div>
				    </#if>
		        </#if>	
			</ul>
         </div>
         <div class="commentBox fly-panel detail-box" style="padding-top: 10;">
			<div class="pager page" id="comment">         
		            
			</div>	
			<div class="layui-form layui-form-pane commentEditor">
				<div class="reviewInfo" id="reviewInfo" style="border-radius:25px;display: none;">
					<div class="content" style="line-height: 24px;color: blue;font-size: 14px;margin-bottom: 3px;">@<font class="toName" style="margin-left:5px;">good</font></div>
					<div class="close cancelReply" onclick="nowDelReplay()">X</div>
				</div>
				<div class="layui-form-item layui-form-text">
				       <#if (bbsUserInfo)??>
						 <form id="ajaxForm" action="" method="post">
						    <input type="hidden" value="${postsObj.id}" name="postsId"  />
						    <input type="hidden" value="${postsObj.bbId}" name="bbId"  />
						    <input type="hidden" value="${postsObj.smboId}" name="smboId"  />
						    <input type="hidden" value="0" name="replyId" id="replyId" />
						    <input type="hidden" value="0" name="gradeId" id="gradeId"  />
							<!-- 文本框 -->
							<textarea class="layui-textarea fly-editor" id="content" style="display: none" name="content" lay-verify="content" >  
						             
						    </textarea>

							<div class="cont-right">
							   <br/>
							   <button id="delReplySub" onclick="replySub()" class="layui-btn layui-btn-normal">提交</button>		
							</div>
						</form>
					   <#else>
						<div class="layui-input-block">
							<blockquote class="layui-elem-quote layui-quote-nm layui-alert">
							   <a href="${futRoot}/mine/login">未登录 | 请先登录才能回复内容~</a>
							</blockquote>
						</div>
					  </#if>
				</div>	
				
			</div>
		</div>
		<!-- 回帖信息 end -->
		
	</div>
</div>
<!-- 左边内容end -->

<!-- 右边内容 -->
<div class="edge">
    <div class="fly-panel fly-link">
		<h3 class="fly-panel-title">友情链接</h3> 
		<dl>
			<dd>
			<a href="http://xsh.gxun.edu.cn" target="_blank">相思湖网站</a>
			<dd>
            <dd>
			<a href="http://lhzy.gxufe.cn/" target="_blank">莲湖之约</a>
			<dd>
            <dd>
			<a href="http://www.konggu.net/" target="_blank">空谷校园</a>
			<dd>
            <dd>
			<a href="http://www.newgxu.cn/" target="_blank">雨无声</a>
			<dd>
            <dd>
			<a href="http://nhcf.gxmu.edu.cn/" target="_blank">南湖晨风</a>
			<dd>
            <dd>
			<a href="http://www.hong-ye.net/" target="_blank">红叶网</a>
			<dd>
            <dd>
			<a href="http://redriver.gxtc.edu.cn/" target="_blank">红水河网</a>
			<dd>		
        </dl>
	</div>	
    
    <div class="fly-panel fly-wailaa-adver">
        <div class="fly-wailaa-block">
            <img src="${resultImgPath}/bbs/bbs_icon/qrcode_qq.jpg" class="qrcode" style="max-width: 100%;" alt="layui">
            <p style="position: relative; top: -10px; color: #666;">加入开发【QQ群】</p>
        </div>
    </div>

</div>
<!-- 右边内容 end -->

</div>
<!-- content  end  -->

<!-- footer -->
<div class="footer">
	<p>

		Copyright @ 2018<a href="#" id="Cooperation"> 云朵家技术团队</a> 版权所有
		<a class="display" target="_blank" href="#"><img src="${resultImgPath}/bbs/bbs_icon/ga.png"/>鄂ICP备18018426号-1</a>
	</p>
</div>
<!-- footer end -->

<!-- layui 2.0 -->
<script src="${resRoot}/view/js/layui.all.js" ></script>

<script type="text/javascript">
var index=null;
var layedit=null;
var layer=null;
   layui.use(['layer', 'form','layedit'], function(){
	   layedit= layui.layedit;
	   layer=layui.layer;
		//图片上传
	   var docName="bbs_reply";//添加帖子，富文本图片保存
	   layedit.set({
		   uploadImage: {
		     url:'${futRoot}/upload?docName='+docName //接口url
		     ,type: 'post' //默认post 
		   }
	   });
	  
	  //富文本编辑器自定义工具栏
      index=  layedit.build('content', {
            height: 160,
			tool: [ //自定义工具栏
			       /* 'strong' //加粗
			       ,'italic' //斜体
			       ,'underline' //下划线
			       ,'del' //删除线
			       
			       ,'|' //分割线
			       
			       ,'left' //左对齐
			       ,'center' //居中对齐
			       ,'right' //右对齐 */
			       'face' //表情
			       ,'link' //超链接
			       ,'image' //插入图片
			     ]
      })

	  /*  {
		  "code": 0 //0表示成功，其它失败
		  ,"msg": "" //提示信息 //一般上传失败后返回
		  ,"data": {
		    "src": "图片路径"
		    ,"title": "图片名称" //可选
		  }
		} */

   });

   /**
   点赞，收藏
   
   */
   function checkButTyp(id,type,className,num){
	   //隐藏onclick
	   $("#"+className).attr("onclick","");
	   $.ajax({
			url :"${futRoot}/cont/updatePosts",
			type : "post",
			dataType : "json",
		    async: false,
			data : {
               "type":type,
               "id":id
			},
			success : function(data) {//1-成功 2-失败  3-登录
				console.info(data);
				if(data=='3'){
					layer.msg("未登录...");return false;
				}else if(data=='2'){
					layer.msg("提交失败...");return false;
				}else if(data=='4'){
					layer.msg("已收藏");return false;
				}else{
					$("."+className).text(num+1);
					layer.msg("感谢支持");return false;
				}
			}
		});
   }
	
   function replySub(){
	  layedit.sync(index);
	  /* if(layedit.getContent(index).trim()=="" ){
		  layer.msg("提交内容不能为空...");return false;
	  }else{ */
		  //去除onclick
		  $("#delReplySub").attr("onclick","");
		   //提交后台处理
		   $.ajax({
				url :"${futRoot}/cont/vf/addBbsReply",
				type : "post",
				dataType : "json",
			    async: false,
				data : $("#ajaxForm").serialize(),
				success : function(data) {
					console.info(data);
					if(data==true){
						//刷新当前页面 
						window.location.reload();
					}else{
						layer.msg("提交失败...");return false;
	                    //添加onclick
	                    $("#delReplySub").attr("onclick","replySub()");
				    }
				}
			}); 
	 //}
	  
   }

  /**
   留言回复
  */
  function nowReplay(id,name,gradeId){
      //显示@框
      $("#reviewInfo").css("display","block");
      //修改@ 姓名及相关属性
      $(".toName").text(name);
      //将ID写入隐藏参数
      $("#replyId").val(id);//父节点（回留言的根节点）
      $("#gradeId").val(gradeId);//留言等级（方便显示层级关系 ）
  }
 /***
 取消回复
 */
 function nowDelReplay(){
	//1.隐藏@框
    $("#reviewInfo").css("display","none");
    //2.恢复相关属性参数
    $("#replyId").val("0");
    $("#gradeId").val("0");
 }

 /**
   查看留言 
 */
  function queryReplyCount(replyId,toName,count){
	  if(replyId!=0 && count!=0){
		  //清除onclick
		  $(".delOnclick_"+replyId).attr("onclick","");
		  $.ajax({
				url :"${futRoot}/cont/detailCount",
				type : "post",
				dataType : "json",
			    async: false,
				data : {
	             "replyId":replyId
				},
				success : function(data) {
					console.info(data);
					if(data=='2'){
						$(".cont-more").hide();
						layer.msg("没有数据啦...");return false;
					}else if(data=='3'){
						layer.msg("出现异常啦 ...");return false;
					}else {
						//console.info(data);
						//var cons="";
						 $.each(data, function(i,val){ 
							var cons= " <div class=\"replyDetail\" reply-id=\"20\" id=\"reply20\"> " +
							           " <div class=\"detail-about detail-about-reply fly-detail-user\"> "+
							           " <div class=\"jieda-comment jieda-reply-sub\">  "+
							           " <a  class=\"delOnclick_"+val.id+"\"  onclick=\"queryReplyCount( "+val.id+",'"+val.createUserName+"',"+val.replyCout+" )\"> "+
							           " <span type=\"deleteReply\" class=\"comment-btn\" reply-id=\"21\"> 留言  ("+val.replyCout+") </span></a> "+
							           " <a href=\"#reviewInfo\" onclick=\"nowReplay("+val.id+",'"+val.createUserName+"',"+(val.gradeId)+")  \"> "+
							           " <span type=\"reply\" class=\"reply-btn\" reply-id=\"21\"> <i class=\"iconfont icon-comment\"></i>回复   </span></a> "+
								       " </div>  "+
								       " <div class=\"jie-user reply-user\"> " +
								       " <a href=\"${futRoot}/mine/preview?id="+val.createUserId+"\" target=\"_blank\" > <img src=\"${resultImgPath}/bbs/bbs_icon/"+val.imgPath+"\"  /> </a>  "+
								       " <cite> <a href=\"#\"> <i class=\"replyAuthor\">"+val.createUserName+"</i> </a> <em>"+val.createDateStr+"</em> <em class=\"display\">回复：</em>  "+ 
								       " <i class=\"blue display\"> <a href=\"#\">"+toName+"</a> </i>  "+ 
								       " </cite> </div> </div>  "+
								       " <div class=\"detail-body reply-body jieda-body photos\"> "+val.content+" "+ 
								       " </div></div>" +
							           " <div id=\"selCount_"+val.id+"\" class=\"replayList replayDetail64\"> </div> ";
							$("#selCount_"+replyId).append(cons);
						 }); 
						 
					}
				}
		  });
	 }
	  
  } 

   /**
   获取更多
   
   */
   var currentPage=1;
   function queryDetailPage(id){
	   currentPage++;
	   $.ajax({
			url :"${futRoot}/cont/detailPage",
			type : "post",
			dataType : "json",
		    async: false,
			data : {
               "currentPage":currentPage,
               "id":id
			},
			success : function(data) {
				console.info(data);
				if(data=='2'){
					$(".cont-more").hide();
					//layer.msg("没有数据啦...");return false;
				}else if(data=='3'){
					layer.msg("出现异常啦 ...");return false;
				}else {
					//console.info(data);
					 $.each(data, function(i,val){ 
						 var cons= " <li data-id=\"13\" id=\"comment13\" data-type=\"discuz\"> " +
					           " <div class=\"detail-about detail-about-reply fly-detail-user\"> " +
					           " <div class=\"jieda-comment\"> " +
					           " <a class=\"delOnclick_"+val.id+"\" onclick=\"queryReplyCount( "+val.id+",'"+val.createUserName+"',"+val.replyCout+" )\"> "+
							   " <span type=\"comment\" class=\"comment-btn\"> "+
							   " 留言  ("+val.replyCout+") "+
							   " </span>  </a> "+
					           " <a href=\"#reviewInfo\" onclick=\"nowReplay("+val.id+",'"+val.createUserName+"',"+(val.id)+")  \"> " +
					           " <span type=\"comment\" class=\"comment-btn\"> " +
					           " <i class=\"iconfont icon-comment\"></i>回复  " +
					           " </span> </a></div> " +
					           " <div class=\"jie-user comment-user\"><a href=\"${futRoot}/mine/preview?id="+val.createUserId+"\" target=\"_blank\"> " +
					           " <img src=\"${resultImgPath}/bbs/bbs_icon/"+val.imgPath+"\" > " +
					           " <cite> <i>"+val.createUserName+"</i> </cite>  </a> </div> " +
					           " <div class=\"detail-hits\"> <span> "+val.createDateStr+ "</span> </div> </div> " +
					           " <div class=\"detail-body comment-body jieda-body photos\">"+val.content+" </div></li> "+
					           " <div id=\"selCount_"+val.id+"\" class=\"replayList replayDetail64\"> </div>";
						  $("#nedv").append(cons);
					 });   
						
				}
			}
		}); 
   }
</script>


</body>
</html>